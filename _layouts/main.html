<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>
        {% if page.title != 'Home' %}
        {{page.title}} | {{site.title}}
        {% else %}
        {{site.title}}
        {% endif %}
    </title>

    <link rel="stylesheet" href="{{site.baseurl}}//use.fontawesome.com/releases/v5.0.7/css/all.css">
    <link rel="stylesheet" href="{{site.baseurl}}/css/site.css">
    <link rel="icon" href="{{site.baseurl}}/images/site-logo.png">
<!--    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">-->
</head>

<script>

    window.onload = () =>{
        document.querySelector('body').classList.add('loaded');

        //TODO: FOLLOWING PIECE OF CODE IN SEPARATE FILE AND INCLUDE IT IF THE PAGE IS INDEX

        (async function indexAnimation()  {

            const elements = {

                forwardArrow: document.querySelector('.forward'),
                backwardArrow: document.querySelector('.backward'),
                imageParent: document.querySelector('.index-banner .images'),
            };

            let c = 0;

            if (!elements.imageParent){
                return;
            }

            const imagesLength = elements.imageParent.children.length;
            let nextImage = elements.imageParent.children[0];

            let id = -1;
            let isLast = false;

            const actions = {
                showNext: async () =>{

                    // currentImage.style.opacity = '0';

                    id++;

                    isLast = (id === imagesLength);

                    if (id >= imagesLength){
                        id = 0;
                    }

                    if (!elements.imageParent){
                        return;
                    }

                    nextImage = elements.imageParent.children[id];
                    actions.setImageProperties('100%', 'auto', 'translateX(0px)', nextImage);

                    elements.forwardArrow.onclick = null;

                    const prevIndex = (id - 1) >= 0 ? (id - 1) : (imagesLength - 1);
                    const prevImage = elements.imageParent.children[prevIndex];

                    if (isLast){
                        actions.setImageProperties('0', '0', 'translateX(-1500px)', prevImage);
                    }

                    else {
                        await setTimeout(() =>{
                            actions.setImageProperties('0', '0', 'translateX(-1500px)', prevImage);
                            elements.forwardArrow.addEventListener('click', actions.showNext);

                        }, 2.0 * 1000);
                    }
                },

                showPrev: async () =>{

                    id--;

                    if (id < 0){
                        id = imagesLength - 1;
                    }

                    const prevImage = elements.imageParent.children[id];
                    prevImage.style.height = 'auto';
                    prevImage.style.width = '100%';
                    prevImage.style.transform = 'translateX(0px)';

                    await setTimeout(() =>{
                        const nextImage = elements.imageParent.children[id + 1];
                        nextImage.style.height = '0';
                        nextImage.style.width = '0';
                        nextImage.style.transform = 'translateX(-1500px)';
                        nextImage.style.zIndex = '0';

                    }, 2 * 1000);
                },

                resetHeight: () =>{
                    elements.imageParent.style.height = nextImage.clientHeight + 'px';
                    // elements.imageParent.style.height = 500 + 'px';
                },

                setImageProperties: (width, height, transform, img) => {
                    img.style.width = width;
                    img.style.height = height;
                    img.style.transform = transform;
                }
            };

            // elements.forwardArrow.addEventListener('click', async () =>{
            //      await clearInterval(c);
            //      await actions.showNext();
            //      c = setInterval(actions.showNext, 5000);
            //
            // });

            // elements.backwardArrow.addEventListener('click', async () =>{
            //     await clearInterval(c);
            //     await actions.showPrev();
            //     c = setInterval(actions.showNext, 5000);
            // });

            actions.resetHeight();
            window.addEventListener('resize', actions.resetHeight);

            await actions.showNext();
            c = setInterval(actions.showNext, 4000);
        }());
    }
</script>

<body>
<!--<input type="checkbox" id="input-checkbox" class="input-checkbox">-->

<header class="site-header">
    {% include site-logo.html location ="header" %}
    {% include navigation.html location="header" %}
</header>

<main class="site-main">
    {% if page.title and page.title != 'Начало' and page.title != 'Планински' and page.title != 'Шосейни' %}
    <h1 class="page-title">{{page.title}}</h1>
    {% endif %}
    <div class="page-content">
        {{content}}
    </div>
</main>

<footer class="site-footer">

    <div class="partners">
        <h4>Нашите партньори :</h4>

        <ul>
            <li>
                <a href="https://dragzone.bg/">
                    <img src="https://dragzone.bg/media/global/logo/default/DRAGZONE_6436-1910px-01.png" alt="drag-zone">
                </a>
            </li>

            <li>
                <a href="https://www.sportdepot.bg/">
                    <img src="https://www.sportdepot.bg/templates/sportdepot/images/logo.png" alt="sport-depot">
                </a>
            </li>

            <li>
                <a href="https://bikes4you.eu/bg">
                    <img src="https://bikes4you.eu/img/bikes4you_invert_16670.png" alt="bikes-for-you">
                </a>
            </li>

            <li>
                <a href="https://www.decathlon.bg/">
                    <img src="https://www.bgbeactive.org/wp-content/uploads/2015/03/decathlon-logo.jpg" alt="decathlon">
                </a>
            </li>
        </ul>
    </div>

    <div class="social-media">
        <h4>Последвайте ни в социалните мрежи :</h4>
        <ul>
            <li>
                <a class="fb" href="https://www.facebook.com/emil.lubomirov.58">
                    Facebook
                </a>
            </li>
            <li>
                <a class="instagram" href="https://twitter.com/emillubomirov">
                    Instagram
                </a>
            </li>
            <li>
                <a class="twitter" href="https://www.instagram.com/?hl=bg">
                    Twitter
                </a>
            </li>
        </ul>
    </div>

    <div class="contacts">
        <h4>Очакваме Вашите въпроси на :</h4>

        <ul>
            <li>
                <a class="email">{{site.email}}</a>
            </li>
            <li>
                <a class="phone">{{site.phone}}</a>
            </li>
        </ul>
    </div>
    <span>
        Всички права запазени 2020 &copy;
    </span>
</footer>
</body>
</html>